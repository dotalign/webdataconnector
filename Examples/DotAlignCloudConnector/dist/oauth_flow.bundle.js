(()=>{var e={300:(e,t)=>{"use strict";var a=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==a)return a;throw new Error("unable to locate global object")}();e.exports=t=a.fetch,a.fetch&&(t.default=a.fetch.bind(a)),t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response},710:(e,t,a)=>{const n=a(300),o=a(680);async function s(e,t){const a=await n(e,{method:"POST",body:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}});return console.log("Response: "),o.logObject(a),a.json()}async function r(e,t){return(await n(e,{method:"GET",headers:{Authorization:"Bearer "+t}})).json()}async function i(e){var t=`https://login.microsoftonline.com/${e.tenant_id}/oauth2/v2.0/token`,a=`grant_type=${e.grant_type}&client_id=${e.client_id}&client_secret=${e.client_secret}&tenant_id=${e.tenant_id}&scope=${e.scope}`;return await s(t,a)}async function c(e,t,a){for(var n=0,o=null;n<e;)try{o=await r(t,a);break}catch(t){if(console.log(t),++n==e)throw console.log(`Failed to get data after ${e} tries...`),{exception:t,response:o}}return o}async function l(e,t,a,n){for(var o=a.totalFetchCount,s=0,r=!0,i=[];r&&s<o;){var l=Date.now(),u=await n(e,a),d=null;try{d=await c(3,u,t);for(var m=0;m<d.data.length;m++)i.push(d.data[m])}catch(e){throw console.log(`And exception was encountered while fetching data. ${s} records fetched so far.`),e.fetched=s,e}r=d.are_more,a.skip+=a.take,s+=d.data.length;var p=Date.now()-l;console.log(`Fetched ${d.page_start} to ${d.page_end} in ${p} ms`)}return console.log(`Done...fetched ${s} records`),{fetched:s,data:i}}e.exports={postData:s,postDataGetResponse:async function(e,t){const a=await n(e,{method:"POST",body:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}});console.log("Response: "),o.logObject(a);var s=a.json();return console.log("Response json: "),o.logObject(s),{response:a,json:s}},getAccessToken:i,fetchDCWithAccessToken:async function(e,t,a,n){for(var o=!1,s=0,r=e.apiBaseUrl;!o;){t.skip=s;var i=null;try{var c=Date.now();i=await l(r,n,t,a);var u=Date.now()-c;console.log(`Finished a run in ${u} ms. ${i.fetched} items were fetched.`),o=!0}catch(e){console.log(`An exception was encountered. Fetched ${e.fetched} so far.`),console.error(e),s=e.fetched}}return i},fetchDC:async function(e,t,a){for(var n=await i(e),s=n.access_token,r=!1,c=0,u=e.apiBaseUrl;!r;){t.skip=c;var d=null;try{var m=process.hrtime();d=await l(u,s,t,a);var p=process.hrtime(m);console.log(`Finished a run in ${p[0]} seconds. ${d.fetched} items were fetched.`),r=!0}catch(t){o.logObject(t),console.log(`An exception was encountered. Fetched ${t.fetched} so far.`),c=t.fetched,s=(n=await i(e)).access_token}}}}},817:(e,t,a)=>{var n=a(710),o=a(157),s=a(225),r=a(680),c=a(591),l=a(595);e.exports={getSchema:function(e){e([c.getSchema(),l.getSchema()])},getData:function(e,t,a,u){var d=s.getEnvironmentParams();r.logObject(t);var m=[];(async function(e,t,a,s,r){var i=null,u=null;switch(s){case c.getTableName():i={totalFetchCount:1e3,teamNumber:1,skip:0,take:500,detailLevel:"IncludeDependentDetailsAndInteractionStats"},u=o.peopleFetchUrlCreator;break;case l.getTableName():i={totalFetchCount:1e3,teamNumber:1,skip:0,take:500,detailLevel:"IncludeDependentDetailsAndInteractionStats"},u=o.companiesFetchUrlCreator;break;default:throw`Unexpected category of data requested: ${s}`}r.reportProgress("Starting to fetch data from DotAlign...");var d=await n.fetchDCWithAccessToken(t,i,u,e);return r.reportProgress("Done fetching data from DotAlign..."),d.data})(e,d,0,t.tableInfo.id,u).then((e=>{switch(t.tableInfo.id){case c.getTableName():m=function(e,t){var a=[];for(i=0;i<e.length;i++){var n=e[i];t.reportProgress(n.PersonNameText),null==n.Stats&&(n.Stats={});var o={full_name:n.PersonNameText,job_title:n.BestJobTitleText,company_name:n.BestJobMatchedCompanyName||n.BestJobCorpLevelCompanyName,email_address:n.BestEmailAddrText,best_introducer:n.BestKnowerNameText,relationship_score:n.WeKnowPersonScore,latest_meeting_date:n.Stats.LastMeeting,latest_meeting_with:n.Stats.LastMeetingUserName,latest_email_to_contact_date:n.Stats.LastOutboundMsg,latest_email_to_contact_sender:n.Stats.FirstOutboundMsgUserName,latest_email_from_contact_date:n.Stats.LastInboundMsg,latest_email_from_contact_recepient:n.Stats.LastInboundMsgUserName};a.push(o)}return a}(e,u);break;case l.getTableName():m=function(e,t){var a=[];for(i=0;i<e.length;i++){var n=e[i];console.log("Processing company: "),r.logObject(n),t.reportProgress(n.CompanyNameText),null==n.Stats&&(n.Stats={});var o={company_name:n.CompanyNameText,company_url:n.BestUrlText,company_relationship_score:n.WeKnowCompanyScore,best_contact_name:n.AnchorEmployeeNameText,best_contact_job_title:n.AnchorTitleText,best_introducer_name:n.BestKnowerNameText,introducer_contact_relationship_score:n.AnchorEmployeeBestKnowerP2PScore,latest_meeting_date:n.Stats.LastMeeting,latest_meeting_organizer:n.Stats.LastMeetingUserName,latest_meeting_contact:n.Stats.LastMeetingContactName,latest_inbound_email_date:n.Stats.LastInboundMsg,latest_inbound_email_sender:n.Stats.LastInboundMsgContactName,latest_inbound_email_recipient:n.Stats.LastInboundMsgUserName,latest_outbound_email_date:n.Stats.LastOutboundMsg,latest_outbound_email_sender:n.Stats.LastOutboundMsgUserName,latest_outbound_email_recipient:n.Stats.LastOutboundMsgContactName};if(null!=n.Urls){var s=[];for(j=0;j<n.Urls.data.length;j++){var c=n.Urls.data[j].UrlText;s.push(c)}o.urls=s}if(null!=n.Aliases){var l=[];for(k=0;k<n.Aliases.data.length;k++){var u=n.Aliases.data[k].NameText;l.push(u)}o.names=l}a.push(o)}return t.reportProgress("Done converting data from DotAlign to Tableau format"),a}(e,u);break;default:throw`Unexpected table name: ${t.tableInfo.id}`}t.appendRows(m),a()}))}}},157:e=>{e.exports={teamMemberFetchUrlCreator:async function(e,t){return`${e}/teams/${t.teamNumber}/members?Skip=${t.skip}&Take=${t.take}&IncludeHealthStats=${t.includeHealthStats}`},peopleFetchUrlCreator:async function(e,t){return`${e}/people?SourceTeam=${t.teamNumber}&Skip=${t.skip}&Take=${t.take}&IncludeDetailLevel=${t.detailLevel}`},companiesFetchUrlCreator:async function(e,t){return`${e}/companies?SourceTeam=${t.teamNumber}&Skip=${t.skip}&Take=${t.take}&IncludeDetailLevel=${t.detailLevel}`},contributorPeopleFetchUrlCreator:async function(e,t){var a=t.teamNumber,n=t.skip,o=t.take,s=t.detailLevel;return`${e}/users/${t.contributorKey}/people?SourceTeam=${a}&Skip=${n}&Take=${o}&IncludeDetailLevel=${s}`},contributorCompaniesFetchUrlCreator:async function(e,t){var a=t.teamNumber,n=t.skip,o=t.take,s=t.detailLevel;return`${e}/users/${t.contributorKey}/companies?SourceTeam=${a}&Skip=${n}&Take=${o}&IncludeDetailLevel=${s}`}}},680:e=>{async function t(e){console.log(JSON.stringify(e,null,5))}e.exports={logObject:t,asyncExecutor:async function(e,a,n){let o;try{o={success:!0,returnValue:await e(a,n)}}catch(e){t(e),o={success:!1,error:e,returnValue:null}}return o}}},225:(e,t,a)=>{const n=a(680);e.exports={getEnvironmentParams:function(){return environment={apiBaseUrl:"https://dotalign-obhnbxktkccdo-webapp.azurewebsites.net/api",tenant_id:"ef816895-7d31-42b9-a2e6-a2cc244e05c5",grant_type:"client_credentials",client_id:"f4ac093f-f62c-49c6-ad79-b84ac4fe79c1",client_secret:"5RzN~P7dF.irA5b8~dw3XUA.nLheXSb-Jg",scope:"128721d7-3cc6-44b0-97a2-b709323602af/.default",oAuthBaseUrl:"http://localhost",oAuthPort:5001,redirect:"/redirect",tableauBaseUrl:"http://localhost",tableauPort:8888}},printPeople:async function(e){for(var t=0;t<e.length;t++){var a={name:e[t].PersonNameText,emailAddress:e[t].BestEmailAddrText,companyName:e[t].BestJobMatchedCompanyName,jobTitle:e[t].BestJobTitleText,bestIntroducer:e[t].BestKnowerNameText,phoneNumber:e[t].BestPhoneText,relationshipScore:e[t].WeKnowPersonScore};n.logObject(a)}},printTeamMembers:async function(e){for(var t=0;t<e.length;t++){var a={name:e[t].name,emailAddress:e[t].email,teamName:e[t].teamName,teamNumber:e[t].teamNumber};n.logObject(a)}}}},595:e=>{e.exports={getTableName:function(){return"Company"},getSchema:function(){return{id:"Company",columns:[{id:"company_name",dataType:tableau.dataTypeEnum.string},{id:"company_url",dataType:tableau.dataTypeEnum.string},{id:"company_relationship_score",dataType:tableau.dataTypeEnum.int},{id:"best_contact_name",dataType:tableau.dataTypeEnum.string},{id:"best_contact_job_title",dataType:tableau.dataTypeEnum.string},{id:"best_introducer_name",dataType:tableau.dataTypeEnum.string},{id:"introducer_contact_relationship_score",dataType:tableau.dataTypeEnum.int},{id:"latest_meeting_date",dataType:tableau.dataTypeEnum.datetime},{id:"latest_meeting_organizer",dataType:tableau.dataTypeEnum.string},{id:"latest_meeting_contact",dataType:tableau.dataTypeEnum.string},{id:"latest_inbound_email_date",dataType:tableau.dataTypeEnum.datetime},{id:"latest_inbound_email_sender",dataType:tableau.dataTypeEnum.string},{id:"latest_inbound_email_recipient",dataType:tableau.dataTypeEnum.string},{id:"latest_outbound_email_date",dataType:tableau.dataTypeEnum.datetime},{id:"latest_outbound_email_sender",dataType:tableau.dataTypeEnum.string},{id:"latest_outbound_email_recipient",dataType:tableau.dataTypeEnum.string},{id:"urls",dataType:tableau.dataTypeEnum.string},{id:"names",dataType:tableau.dataTypeEnum.string}]}}}},591:e=>{e.exports={getTableName:function(){return"Contact"},getSchema:function(){return{id:"Contact",columns:[{id:"full_name",dataType:tableau.dataTypeEnum.string},{id:"email_address",dataType:tableau.dataTypeEnum.string},{id:"job_title",dataType:tableau.dataTypeEnum.string},{id:"company_name",dataType:tableau.dataTypeEnum.string},{id:"relationship_score",dataType:tableau.dataTypeEnum.int},{id:"best_introducer",dataType:tableau.dataTypeEnum.string},{id:"latest_meeting_date",dataType:tableau.dataTypeEnum.datetime},{id:"latest_meeting_with",dataType:tableau.dataTypeEnum.string},{id:"latest_email_to_contact_date",dataType:tableau.dataTypeEnum.datetime},{id:"latest_email_to_contact_sender",dataType:tableau.dataTypeEnum.string},{id:"latest_email_from_contact_date",dataType:tableau.dataTypeEnum.datetime},{id:"latest_email_from_contact_recepient",dataType:tableau.dataTypeEnum.string}]}}}}},t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={exports:{}};return e[n](o,o.exports,a),o.exports}(()=>{var e,t=a(225),n=a(817);function o(e){e?(console.log("Page has access token"),$(".notsignedin").css("display","none")):(console.log("Page does not have access token"),$(".notsignedin").css("display","block"))}(e=tableau.makeConnector()).init=function(e){tableau.authType=tableau.authTypeEnum.custom,tableau.phase==tableau.phaseEnum.authPhase&&$("#submitButton").css("display","none"),tableau.phase,tableau.phaseEnum.gatherDataPhase;var t=Cookies.get("accessToken"),a=t&&t.length>0||tableau.password.length>0;if(o(a),e(),(tableau.phase==tableau.phaseEnum.interactivePhase||tableau.phase==tableau.phaseEnum.authPhase)&&a)return tableau.password=t,void(tableau.phase==tableau.phaseEnum.authPhase&&tableau.submit())},e.getSchema=function(e){n.getSchema(e)},e.getData=function(e,t){var a=Cookies.get("accessToken")||tableau.password;n.getData(a,e,t,tableau)},tableau.registerConnector(e),$(document).ready((function(){var e=Cookies.get("accessToken"),a=e&&e.length>0;a?(console.log("Access token was found. Setting it into the password field."),tableau.password=e):console.log("Access token was not found"),o(a),$("#connectbutton").click((function(){!function(){var e=t.getEnvironmentParams(),a=`https://login.microsoftonline.com/${e.tenant_id}/oauth2/v2.0/authorize`,n=e.oAuthBaseUrl+":"+e.oAuthPort+e.redirect,o=`${a}?client_id=${e.client_id}&response_type=code&redirect_uri=${n}&scope=${e.scope}&`;console.log("Full authorization url: "),console.log(o),window.location.href=o}()})),$("#submitButton").click((function(){tableau.connectionName="DotAlign Cloud API",tableau.submit()}))}))})()})();