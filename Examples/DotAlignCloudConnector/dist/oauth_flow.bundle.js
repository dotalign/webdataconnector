(()=>{var e,t,n,o,a,r={300:(e,t)=>{"use strict";var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},710:(e,t,n)=>{const o=n(300),a=n(680);async function r(e,t){return(await o(e,{method:"GET",headers:{Authorization:"Bearer "+t}})).json()}async function c(e){var t=`https://login.microsoftonline.com/${e.tenant_id}/oauth2/v2.0/token`,n=`grant_type=${e.grant_type}&client_id=${e.client_id}&client_secret=${e.client_secret}&tenant_id=${e.tenant_id}&scope=${e.scope}`;return await async function(e,t){const n=await o(e,{method:"POST",body:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}});return console.log("Response: "),a.logObject(n),n.json()}(t,n)}async function s(e,t,n){for(var o=0,a=null;o<e;)try{a=await r(t,n);break}catch(t){if(console.log(t),++o==e)throw console.log(`Failed to get data after ${e} tries...`),{exception:t,response:a}}return a}async function i(e,t,n,o){for(var a=n.totalFetchCount,r=0,c=!0,i=[];c&&r<a;){var l=process.hrtime(),u=await o(e,n),d=null;try{d=await s(3,u,t);for(var p=0;p<d.data.length;p++)i.push(d.data[p])}catch(e){throw console.log(`And exception was encountered while fetching data. ${r} records fetched so far.`),e.fetched=r,e}c=d.are_more,n.skip+=n.take,r+=d.data.length;var m=process.hrtime(l),h=m[0],f=m[1];console.log(`Fetched ${d.page_start} to ${d.page_end} in ${h}.${f}s`)}return console.log(`Done...fetched ${r} records`),{fetched:r,data:i}}e.exports={fetchDCWithAccessToken:async function(e,t,n,o){for(var r=!1,c=0,s=e.apiBaseUrl;!r;){t.skip=c;var l=null;try{var u=process.hrtime();l=await i(s,o,t,n);var d=process.hrtime(u);console.log(`Finished a run in ${d[0]} seconds. ${l.fetched} items were fetched.`),r=!0}catch(e){a.logObject(e),console.log(`An exception was encountered. Fetched ${e.fetched} so far.`),c=e.fetched}}return l},fetchDC:async function(e,t,n){for(var o=await c(e),r=o.access_token,s=!1,l=0,u=e.apiBaseUrl;!s;){t.skip=l;var d=null;try{var p=process.hrtime();d=await i(u,r,t,n);var m=process.hrtime(p);console.log(`Finished a run in ${m[0]} seconds. ${d.fetched} items were fetched.`),s=!0}catch(t){a.logObject(t),console.log(`An exception was encountered. Fetched ${t.fetched} so far.`),l=t.fetched,r=(o=await c(e)).access_token}}}}},157:e=>{e.exports={teamMemberFetchUrlCreator:async function(e,t){return`${e}/teams/${t.teamNumber}/members?Skip=${t.skip}&Take=${t.take}&IncludeHealthStats=${t.includeHealthStats}`},peopleFetchUrlCreator:async function(e,t){return`${e}/people?SourceTeam=${t.teamNumber}&Skip=${t.skip}&Take=${t.take}&IncludeDetailLevel=${t.detailLevel}`},contributorPeopleFetchUrlCreator:async function(e,t){var n=t.teamNumber,o=t.skip,a=t.take,r=t.detailLevel;return`${e}/users/${t.contributorKey}/people?SourceTeam=${n}&Skip=${o}&Take=${a}&IncludeDetailLevel=${r}`},contributorCompaniesFetchUrlCreator:async function(e,t){var n=t.teamNumber,o=t.skip,a=t.take,r=t.detailLevel;return`${e}/users/${t.contributorKey}/companies?SourceTeam=${n}&Skip=${o}&Take=${a}&IncludeDetailLevel=${r}`}}},680:e=>{async function t(e){console.log(JSON.stringify(e,null,5))}e.exports={logObject:t,asyncExecutor:async function(e,n,o){let a;try{a={success:!0,returnValue:await e(n,o)}}catch(e){t(e),a={success:!1,error:e,returnValue:null}}return a}}},225:(e,t,n)=>{const o=n(680);e.exports={getEnvironmentParams:function(){return environment={apiBaseUrl:"https://dotalign-obhnbxktkccdo-webapp.azurewebsites.net/api",tenant_id:"ef816895-7d31-42b9-a2e6-a2cc244e05c5",grant_type:"client_credentials",client_id:"f4ac093f-f62c-49c6-ad79-b84ac4fe79c1",client_secret:"5RzN~P7dF.irA5b8~dw3XUA.nLheXSb-Jg",scope:"128721d7-3cc6-44b0-97a2-b709323602af/.default",baseUrl:"http://localhost",port:8888,redirect:"/redirect"}},printPeople:async function(e){for(var t=0;t<e.length;t++){var n={name:e[t].PersonNameText,emailAddress:e[t].BestEmailAddrText,companyName:e[t].BestJobMatchedCompanyName,jobTitle:e[t].BestJobTitleText,bestIntroducer:e[t].BestKnowerNameText,phoneNumber:e[t].BestPhoneText,relationshipScore:e[t].WeKnowPersonScore};o.logObject(n)}},printTeamMembers:async function(e){for(var t=0;t<e.length;t++){var n={name:e[t].name,emailAddress:e[t].email,teamName:e[t].teamName,teamNumber:e[t].teamNumber};o.logObject(n)}}}}},c={};function s(e){if(c[e])return c[e].exports;var t=c[e]={exports:{}};return r[e](t,t.exports,s),t.exports}t=s(710),n=s(157),o=s(225),a=s(680),(e=tableau.makeConnector()).getSchema=function(e){e([{id:"People",alias:"People in the network",columns:[{id:"first_name",dataType:tableau.dataTypeEnum.string},{id:"last_name",alias:"last_name",dataType:tableau.dataTypeEnum.float},{id:"job_title",alias:"job_title",dataType:tableau.dataTypeEnum.string},{id:"company_name",dataType:tableau.dataTypeEnum.geometry},{id:"relationship_score",dataType:tableau.dataTypeEnum.int}]}])},e.getData=function(e,r){var c=o.getEnvironmentParams();console.log("Environment: "),utils.logObject(c);var s=async function(e,o,a,r,c){for(var s={teamNumber:1,skip:0,take:100,includeHealthStats:!1,totalFetchCount:5},i=Cookies.get("accessToken"),l=await t.fetchDCWithAccessToken(e,s,n.teamMemberFetchUrlCreator,i),u=[],d=0;d<l.data.length;d++){var p=l.data[d],m={teamNumber:1,skip:0,take:200,detailLevel:"IncludeDependentDetailsAndInteractionStats",totalFetchCount:100,contributorKey:p.userKey};console.log(`\n\nFetching people for ${p.userKey}`),console.log("-------");var h=await t.fetchDC(e,m,n.contributorPeopleFetchUrlCreator);console.log(`\nFetching companies for ${p.userKey}`),console.log("-------");var f=await t.fetchDC(e,m,n.contributorCompaniesFetchUrlCreator);p.userKey,u.push({contributor:p,people:h,companies:f})}return u}(c).then((e=>e));a.logObject(s),e.appendRows([]),r()},tableau.registerConnector(e),$(document).ready((function(){var e=Cookies.get("accessToken"),t=e&&e.length>0;t?(console.log("Access token was found: "),console.log(e)):console.log("Access token was not found"),function(e){e?$(".notsignedin").css("display","none"):$(".notsignedin").css("display","block")}(t),$("#connectbutton").click((function(){!function(){var e=o.getEnvironmentParams(),t=`https://login.microsoftonline.com/${e.tenant_id}/oauth2/v2.0/authorize`,n=e.baseUrl+":"+e.port+e.redirect,a=`${t}?client_id=${e.client_id}&response_type=code&redirect_uri=${n}&scope=${e.scope}&`;console.log("Full authorization url: "),console.log(a),window.location.href=a}()})),$("#submitButton").click((function(){tableau.connectionName="DotAlign Cloud API",tableau.submit()}))}))})();