(()=>{var e,t,a,n,o={300:(e,t)=>{"use strict";var a=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==a)return a;throw new Error("unable to locate global object")}();e.exports=t=a.fetch,a.fetch&&(t.default=a.fetch.bind(a)),t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response},710:(e,t,a)=>{const n=a(300),o=a(680);async function s(e,t){const a=await n(e,{method:"POST",body:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}});return console.log("Response: "),o.logObject(a),a.json()}async function r(e,t){return(await n(e,{method:"GET",headers:{Authorization:"Bearer "+t}})).json()}async function c(e){var t=`https://login.microsoftonline.com/${e.tenant_id}/oauth2/v2.0/token`,a=`grant_type=${e.grant_type}&client_id=${e.client_id}&client_secret=${e.client_secret}&tenant_id=${e.tenant_id}&scope=${e.scope}`;return await s(t,a)}async function i(e,t,a){for(var n=0,o=null;n<e;)try{o=await r(t,a);break}catch(t){if(console.log(t),++n==e)throw console.log(`Failed to get data after ${e} tries...`),{exception:t,response:o}}return o}async function l(e,t,a,n){for(var o=a.totalFetchCount,s=0,r=!0,c=[];r&&s<o;){var l=Date.now(),u=await n(e,a),d=null;try{d=await i(3,u,t);for(var p=0;p<d.data.length;p++)c.push(d.data[p])}catch(e){throw console.log(`And exception was encountered while fetching data. ${s} records fetched so far.`),e.fetched=s,e}r=d.are_more,a.skip+=a.take,s+=d.data.length;var h=Date.now()-l;console.log(`Fetched ${d.page_start} to ${d.page_end} in ${h} ms`)}return console.log(`Done...fetched ${s} records`),{fetched:s,data:c}}e.exports={postData:s,postDataGetResponse:async function(e,t){const a=await n(e,{method:"POST",body:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}});console.log("Response: "),o.logObject(a);var s=a.json();return console.log("Response json: "),o.logObject(s),{response:a,json:s}},getAccessToken:c,fetchDCWithAccessToken:async function(e,t,a,n){for(var o=!1,s=0,r=e.apiBaseUrl;!o;){t.skip=s;var c=null;try{var i=Date.now();c=await l(r,n,t,a);var u=Date.now()-i;console.log(`Finished a run in ${u} ms. ${c.fetched} items were fetched.`),o=!0}catch(e){console.log(`An exception was encountered. Fetched ${e.fetched} so far.`),console.error(e),s=e.fetched}}return c},fetchDC:async function(e,t,a){for(var n=await c(e),s=n.access_token,r=!1,i=0,u=e.apiBaseUrl;!r;){t.skip=i;var d=null;try{var p=process.hrtime();d=await l(u,s,t,a);var h=process.hrtime(p);console.log(`Finished a run in ${h[0]} seconds. ${d.fetched} items were fetched.`),r=!0}catch(t){o.logObject(t),console.log(`An exception was encountered. Fetched ${t.fetched} so far.`),i=t.fetched,s=(n=await c(e)).access_token}}}}},157:e=>{e.exports={teamMemberFetchUrlCreator:async function(e,t){return`${e}/teams/${t.teamNumber}/members?Skip=${t.skip}&Take=${t.take}&IncludeHealthStats=${t.includeHealthStats}`},peopleFetchUrlCreator:async function(e,t){return`${e}/people?SourceTeam=${t.teamNumber}&Skip=${t.skip}&Take=${t.take}&IncludeDetailLevel=${t.detailLevel}`},contributorPeopleFetchUrlCreator:async function(e,t){var a=t.teamNumber,n=t.skip,o=t.take,s=t.detailLevel;return`${e}/users/${t.contributorKey}/people?SourceTeam=${a}&Skip=${n}&Take=${o}&IncludeDetailLevel=${s}`},contributorCompaniesFetchUrlCreator:async function(e,t){var a=t.teamNumber,n=t.skip,o=t.take,s=t.detailLevel;return`${e}/users/${t.contributorKey}/companies?SourceTeam=${a}&Skip=${n}&Take=${o}&IncludeDetailLevel=${s}`}}},680:e=>{async function t(e){console.log(JSON.stringify(e,null,5))}e.exports={logObject:t,asyncExecutor:async function(e,a,n){let o;try{o={success:!0,returnValue:await e(a,n)}}catch(e){t(e),o={success:!1,error:e,returnValue:null}}return o}}},225:(e,t,a)=>{const n=a(680);e.exports={getEnvironmentParams:function(){return environment={apiBaseUrl:"https://qa.dotalign.com/api",tenant_id:"ef816895-7d31-42b9-a2e6-a2cc244e05c5",grant_type:"client_credentials",client_id:"f4ac093f-f62c-49c6-ad79-b84ac4fe79c1",client_secret:"5RzN~P7dF.irA5b8~dw3XUA.nLheXSb-Jg",scope:"128721d7-3cc6-44b0-97a2-b709323602af/.default",oAuthBaseUrl:"http://localhost",oAuthPort:5001,redirect:"/redirect",tableauBaseUrl:"http://localhost",tableauPort:8888}},printPeople:async function(e){for(var t=0;t<e.length;t++){var a={name:e[t].PersonNameText,emailAddress:e[t].BestEmailAddrText,companyName:e[t].BestJobMatchedCompanyName,jobTitle:e[t].BestJobTitleText,bestIntroducer:e[t].BestKnowerNameText,phoneNumber:e[t].BestPhoneText,relationshipScore:e[t].WeKnowPersonScore};n.logObject(a)}},printTeamMembers:async function(e){for(var t=0;t<e.length;t++){var a={name:e[t].name,emailAddress:e[t].email,teamName:e[t].teamName,teamNumber:e[t].teamNumber};n.logObject(a)}}}}},s={};function r(e){if(s[e])return s[e].exports;var t=s[e]={exports:{}};return o[e](t,t.exports,r),t.exports}e=r(710),t=r(157),a=r(225),n=r(680),function(){var o=tableau.makeConnector();function s(e){e?(console.log("Page has access token"),$(".notsignedin").css("display","none")):(console.log("Page does not have access token"),$(".notsignedin").css("display","block"))}o.init=function(e){tableau.authType=tableau.authTypeEnum.custom,tableau.phase==tableau.phaseEnum.authPhase&&$("#submitButton").css("display","none"),tableau.phase,tableau.phaseEnum.gatherDataPhase;var t=Cookies.get("accessToken"),a=t&&t.length>0||tableau.password.length>0;if(s(a),e(),(tableau.phase==tableau.phaseEnum.interactivePhase||tableau.phase==tableau.phaseEnum.authPhase)&&a)return tableau.password=t,void(tableau.phase==tableau.phaseEnum.authPhase&&tableau.submit())},o.getSchema=function(e){e([{id:"People",alias:"People in the network",columns:[{id:"full_name",dataType:tableau.dataTypeEnum.string},{id:"email_address",alias:"email_address",dataType:tableau.dataTypeEnum.string},{id:"job_title",alias:"job_title",dataType:tableau.dataTypeEnum.string},{id:"company_name",dataType:tableau.dataTypeEnum.string},{id:"relationship_score",dataType:tableau.dataTypeEnum.int},{id:"best_introducer",dataType:tableau.dataTypeEnum.string}]}])},o.getData=function(o,s){var r=a.getEnvironmentParams();console.log("Environment: "),n.logObject(r);var c=[];(async function(a,n){console.log("Starting to get data from DotAlign Cloud...");var o=Cookies.get("accessToken")||tableau.password;console.log("Using the following access token to get data from DotAlign Cloud"),console.log(o);var s={totalFetchCount:100,teamNumber:1,skip:0,take:100,detailLevel:"IncludeDependentDetailsAndInteractionStats"};return(await e.fetchDCWithAccessToken(a,s,t.peopleFetchUrlCreator,o)).data})(r).then((e=>{for(i=0;i<e.length;i++){var t=e[i],a={full_name:t.PersonNameText,job_title:t.BestJobTitleText,company_name:t.BestJobMatchedCompanyName,email_address:t.BestEmailAddrText,best_introducer:t.BestKnowerNameText,relationship_score:t.WeKnowPersonScore};c.push(a)}o.appendRows(c),s()}))},tableau.registerConnector(o),$(document).ready((function(){var e=Cookies.get("accessToken"),t=e&&e.length>0;t?(console.log("Access token was found. Setting it into the password field."),tableau.password=e):console.log("Access token was not found"),s(t),$("#connectbutton").click((function(){!function(){var e=a.getEnvironmentParams(),t=`https://login.microsoftonline.com/${e.tenant_id}/oauth2/v2.0/authorize`,n=e.oAuthBaseUrl+":"+e.oAuthPort+e.redirect,o=`${t}?client_id=${e.client_id}&response_type=code&redirect_uri=${n}&scope=${e.scope}&`;console.log("Full authorization url: "),console.log(o),window.location.href=o}()})),$("#submitButton").click((function(){tableau.connectionName="DotAlign Cloud API",tableau.submit()}))}))}()})();